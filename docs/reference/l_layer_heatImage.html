<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Display a Heat Image — l_layer_heatImage • loon</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Display a Heat Image — l_layer_heatImage"><meta name="description" content="This function is very similar to the
  image function. It works with every loon plot which
  is based on the cartesian coordinate system."><meta property="og:description" content="This function is very similar to the
  image function. It works with every loon plot which
  is based on the cartesian coordinate system."><meta property="og:image" content="https://great-northern-diver.github.io/loon/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">loon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Intro</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/logicalQueries.html">Logical queries in interactive graphics</a></li>
    <li><a class="dropdown-item" href="../articles/savingLoonPlots.html">Saving loon plots</a></li>
    <li><a class="dropdown-item" href="../articles/loonPlotsAndGridGraphics.html">Loon plots and grid graphics</a></li>
    <li><a class="dropdown-item" href="../articles/teaching-example-smoothing.html">Teaching example</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-videos" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Videos</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-videos"><li><a class="external-link dropdown-item" href="https://youtu.be/JFJcg855HcQ">the (not so) humble (interactive) histogram</a></li>
    <li><a class="external-link dropdown-item" href="https://youtu.be/mMJllGOuDLY">3D interactive scatterplots</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/great-northern-diver/loon" aria-label="GitHub repository for loon"><span class="fa fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Display a Heat Image</h1>
      <small class="dont-index">Source: <a href="https://github.com/great-northern-diver/loon/blob/HEAD/R/l_layer_heatImage.R" class="external-link"><code>R/l_layer_heatImage.R</code></a></small>
      <div class="d-none name"><code>l_layer_heatImage.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is very similar to the
  <code><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></code> function. It works with every loon plot which
  is based on the cartesian coordinate system.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">l_layer_heatImage</span><span class="op">(</span></span>
<span>  <span class="va">widget</span>,</span>
<span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  <span class="va">z</span>,</span>
<span>  zlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/is.finite.html" class="external-link">is.finite</a></span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span>,</span>
<span>  ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/range.html" class="external-link">range</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>,</span>
<span>  col <span class="op">=</span> <span class="fu">grDevices</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">heat.colors</a></span><span class="op">(</span><span class="fl">12</span><span class="op">)</span>,</span>
<span>  <span class="va">breaks</span>,</span>
<span>  oldstyle <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">useRaster</span>,</span>
<span>  index <span class="op">=</span> <span class="st">"end"</span>,</span>
<span>  parent <span class="op">=</span> <span class="st">"root"</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-widget">widget<a class="anchor" aria-label="anchor" href="#arg-widget"></a></dt>
<dd><p>widget path as a string or as an object handle</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>locations of grid lines at which the values in z are measured. These
must be finite, non-missing and in (strictly) ascending order. By default,
equally spaced values from 0 to 1 are used. If x is a list, its components
x$x and x$y are used for x and y, respectively. If the list has component z
this is used for z.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>see description for the <code>x</code> argument above</p></dd>


<dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>a numeric or logical matrix containing the values to be plotted
    (<code>NA</code>s are allowed).  Note that <code>x</code> can be used instead
    of <code>z</code> for convenience.</p></dd>


<dt id="arg-zlim">zlim<a class="anchor" aria-label="anchor" href="#arg-zlim"></a></dt>
<dd><p>the minimum and maximum <code>z</code> values for which colors
    should be plotted, defaulting to the range of the finite values of
    <code>z</code>. Each of the given colors will be used to color an
    equispaced interval of this range. The <em>midpoints</em> of the
    intervals cover the range, so that values just outside the range
    will be plotted.</p></dd>


<dt id="arg-xlim">xlim<a class="anchor" aria-label="anchor" href="#arg-xlim"></a></dt>
<dd><p>range for the plotted x values, defaulting to the range of x</p></dd>


<dt id="arg-ylim">ylim<a class="anchor" aria-label="anchor" href="#arg-ylim"></a></dt>
<dd><p>range for the plotted y values, defaulting to the range of y</p></dd>


<dt id="arg-col">col<a class="anchor" aria-label="anchor" href="#arg-col"></a></dt>
<dd><p>a list of colors such as that generated by
    <code><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">hcl.colors</a></code>, <code><a href="https://rdrr.io/r/grDevices/gray.colors.html" class="external-link">gray.colors</a></code> or similar
    functions.</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>a set of finite numeric breakpoints for the colours:
    must have one more breakpoint than colour and be in increasing
    order.  Unsorted vectors will be sorted, with a warning.</p></dd>


<dt id="arg-oldstyle">oldstyle<a class="anchor" aria-label="anchor" href="#arg-oldstyle"></a></dt>
<dd><p>logical. If true the midpoints of the colour intervals
    are equally spaced, and <code>zlim[1]</code> and <code>zlim[2]</code> were taken
    to be midpoints.  The default is to have colour intervals of equal
    lengths between the limits.</p></dd>


<dt id="arg-useraster">useRaster<a class="anchor" aria-label="anchor" href="#arg-useraster"></a></dt>
<dd><p>logical; if <code>TRUE</code> a bitmap raster is used to
    plot the image instead of polygons. The grid must be regular in that
    case, otherwise an error is raised.   For the behaviour when this is
    not specified, see ‘Details’.</p></dd>


<dt id="arg-index">index<a class="anchor" aria-label="anchor" href="#arg-index"></a></dt>
<dd><p>position among its siblings. valid values are 0, 1, 2, ...,
'end'</p></dd>


<dt id="arg-parent">parent<a class="anchor" aria-label="anchor" href="#arg-parent"></a></dt>
<dd><p>a valid Tk parent widget path. When the parent widget is
specified (i.e. not <code>NULL</code>) then the plot widget needs to be placed using
some geometry manager like <code><a href="https://rdrr.io/r/tcltk/TkCommands.html" class="external-link">tkpack</a></code> or <code><a href="https://rdrr.io/r/tcltk/TkCommands.html" class="external-link">tkplace</a></code> in
order to be displayed. See the examples below.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>argumnets forwarded to <code><a href="l_layer_line.html">l_layer_line</a></code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>layer id of group or rectangles layer</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>For more information run: <code>l_help("learn_R_layer.html#countourlines-heatimage-rasterimage")</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"MASS"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">kest</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">iris</span>, <span class="fu">MASS</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/MASS/man/kde2d.html" class="external-link">kde2d</a></span><span class="op">(</span><span class="va">Sepal.Width</span>,<span class="va">Sepal.Length</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span><span class="va">kest</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/graphics/contour.html" class="external-link">contour</a></span><span class="op">(</span><span class="va">kest</span>, add<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="l_plot.html">l_plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">lcl</span> <span class="op">&lt;-</span> <span class="fu"><a href="l_layer_contourLines.html">l_layer_contourLines</a></span><span class="op">(</span><span class="va">p</span>, <span class="va">kest</span>, label<span class="op">=</span><span class="st">'contour lines'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">limg</span> <span class="op">&lt;-</span> <span class="fu">l_layer_heatImage</span><span class="op">(</span><span class="va">p</span>, <span class="va">kest</span>, label<span class="op">=</span><span class="st">'heatmap'</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="l_scaleto_world.html">l_scaleto_world</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># from examples(image)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">*</span><span class="va">pi</span>, <span class="fl">4</span><span class="op">*</span><span class="va">pi</span>, len <span class="op">=</span> <span class="fl">27</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/outer.html" class="external-link">outer</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span>, <span class="va">y</span><span class="op">^</span><span class="fl">2</span>, <span class="st">"+"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="l_plot.html">l_plot</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">l_layer_heatImage</span><span class="op">(</span><span class="va">p1</span>, z <span class="op">=</span> <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">r</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>, col  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">32</span><span class="op">)</span><span class="op">/</span><span class="fl">32</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="l_scaleto_world.html">l_scaleto_world</a></span><span class="op">(</span><span class="va">p1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html" class="external-link">image</a></span><span class="op">(</span>z <span class="op">=</span> <span class="va">z</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">cos</a></span><span class="op">(</span><span class="va">r</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">r</span><span class="op">/</span><span class="fl">6</span><span class="op">)</span>, col  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/gray.html" class="external-link">gray</a></span><span class="op">(</span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">32</span><span class="op">)</span><span class="op">/</span><span class="fl">32</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Waddell, R. Wayne Oldford.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

