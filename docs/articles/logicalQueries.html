<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Logical queries • loon</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Logical queries">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="default" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">loon</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/introduction.html">Intro</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/introduction.html">Introduction</a></li>
    <li><a class="dropdown-item" href="../articles/logicalQueries.html">Logical queries in interactive graphics</a></li>
    <li><a class="dropdown-item" href="../articles/savingLoonPlots.html">Saving loon plots</a></li>
    <li><a class="dropdown-item" href="../articles/loonPlotsAndGridGraphics.html">Loon plots and grid graphics</a></li>
    <li><a class="dropdown-item" href="../articles/teaching-example-smoothing.html">Teaching example</a></li>
  </ul>
</li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-videos" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Videos</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-videos">
<li><a class="external-link dropdown-item" href="https://youtu.be/JFJcg855HcQ">the (not so) humble (interactive) histogram</a></li>
    <li><a class="external-link dropdown-item" href="https://youtu.be/mMJllGOuDLY">3D interactive scatterplots</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/great-northern-diver/loon" aria-label="GitHub repository for loon"><span class="fa fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Logical queries</h1>
                        <h4 data-toc-skip class="author">R.W.
Oldford</h4>
            
            <h4 data-toc-skip class="date">September 5, 2021</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/great-northern-diver/loon/blob/HEAD/vignettes/logicalQueries.Rmd" class="external-link"><code>vignettes/logicalQueries.Rmd</code></a></small>
      <div class="d-none name"><code>logicalQueries.Rmd</code></div>
    </div>

    
    
<p>One of the principal strengths of linked plots is the ease with which
one can form complex logical queries on the data.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://great-northern-diver.github.io/loon/">loon</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="the-cars-of-the-1974-motor-trends-magazine">The cars of the 1974 Motor Trends magazine<a class="anchor" aria-label="anchor" href="#the-cars-of-the-1974-motor-trends-magazine"></a>
</h2>
<p>Begin with a classic data set in <code>R</code> –
<code>mtcars</code>.<br>
For the sake of illustration, some enrichment of the variables and their
values will be made:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">mtcars</span>, package <span class="op">=</span> <span class="st">"datasets"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">country</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Japan"</span>, <span class="st">"Japan"</span>, <span class="st">"Japan"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, </span>
<span>                    <span class="st">"Germany"</span>, <span class="st">"Germany"</span>, <span class="st">"Germany"</span>, <span class="st">"Germany"</span>, <span class="st">"Germany"</span>, </span>
<span>                    <span class="st">"Germany"</span>, <span class="st">"Germany"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"Italy"</span>, </span>
<span>                    <span class="st">"Japan"</span>, <span class="st">"Japan"</span>, <span class="st">"Japan"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, <span class="st">"USA"</span>, </span>
<span>                    <span class="st">"Italy"</span>, <span class="st">"Germany"</span>, <span class="st">"UK"</span>, <span class="st">"USA"</span>, <span class="st">"Italy"</span>, <span class="st">"italy"</span>, <span class="st">"Sweden"</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">continent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Asia"</span>, <span class="st">"Asia"</span>, <span class="st">"Asia"</span>, <span class="st">"North America"</span>, <span class="st">"North America"</span>, </span>
<span>                      <span class="st">"North America"</span>, <span class="st">"North America"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, </span>
<span>                      <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>,  </span>
<span>                      <span class="st">"North America"</span>, <span class="st">"North America"</span>, <span class="st">"North America"</span>, </span>
<span>                      <span class="st">"Europe"</span>, <span class="st">"Asia"</span>, <span class="st">"Asia"</span>, <span class="st">"Asia"</span>, <span class="st">"North America"</span>, </span>
<span>                      <span class="st">"North America"</span>, <span class="st">"North America"</span>, <span class="st">"North America"</span>, </span>
<span>                      <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"North America"</span>, </span>
<span>                      <span class="st">"Europe"</span>, <span class="st">"Europe"</span>, <span class="st">"Europe"</span> <span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">company</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Mazda"</span>, <span class="st">"Mazda"</span>, <span class="st">"Nissan"</span>, <span class="st">"AMC"</span>, <span class="st">"AMC"</span>, <span class="st">"Chrysler"</span>, </span>
<span>                    <span class="st">"Chrysler"</span>, <span class="st">"Mercedes"</span>, <span class="st">"Mercedes"</span>, <span class="st">"Mercedes"</span>, <span class="st">"Mercedes"</span>,</span>
<span>                    <span class="st">"Mercedes"</span>, <span class="st">"Mercedes"</span>, <span class="st">"Mercedes"</span>, <span class="st">"GM"</span>, <span class="st">"Ford"</span>, </span>
<span>                    <span class="st">"Chrysler"</span>, <span class="st">"Fiat"</span>, <span class="st">"Honda"</span>, <span class="st">"Toyota"</span>, <span class="st">"Toyota"</span>, <span class="st">"Chrysler"</span>, </span>
<span>                    <span class="st">"AMC"</span>, <span class="st">"GM"</span>, <span class="st">"GM"</span>, <span class="st">"Fiat"</span>, <span class="st">"Porsche"</span>, <span class="st">"Lotus"</span>, <span class="st">"Ford"</span>, </span>
<span>                    <span class="st">"Ferrari"</span>, <span class="st">"Maserati"</span>, <span class="st">"Volvo"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">Engine</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V-shaped"</span>, <span class="st">"Straight"</span><span class="op">)</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span> <span class="op">+</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                        levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"V-shaped"</span>, <span class="st">"Straight"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">Transmission</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"automatic"</span>, <span class="st">"manual"</span><span class="op">)</span><span class="op">[</span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">+</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                              levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"automatic"</span>, <span class="st">"manual"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">vs</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>  <span class="co"># These are redundant now</span></span>
<span><span class="va">mtcars</span><span class="op">$</span><span class="va">am</span> <span class="op">&lt;-</span> <span class="cn">NULL</span>  <span class="co"># </span></span></code></pre></div>
<p>For this illustration, it will be convenient to separate categorical
from continuous data.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">varTypes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/split.html" class="external-link">split</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, </span>
<span>                  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mtcars</span>, </span>
<span>                         FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>                             <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">is.factor</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">|</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">is.character</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">{</span> </span>
<span>                                 <span class="st">"categorical"</span></span>
<span>                                  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span><span class="st">"numeric"</span><span class="op">}</span> <span class="op">}</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><code>varTypes</code> is a list with two named components:
<code>categorical</code> and <code>numeric</code>.</p>
</div>
<div class="section level2">
<h2 id="some-interactive-plots">Some interactive plots<a class="anchor" aria-label="anchor" href="#some-interactive-plots"></a>
</h2>
<p>To explore the data, several interactive plots will likely have been
constructed. Typically, these will have been constructed one at a time
and assigned to the same linking group (perhaps via the inspector).</p>
<p>Below, histograms/barplots are constructed for each categorical
variable and assigned to that variable name now prefixed by
<code>h_</code> for “histogram”.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">varName</span> <span class="kw">in</span> <span class="va">varTypes</span><span class="op">$</span><span class="va">categorical</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/assign.html" class="external-link">assign</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"h_"</span>, <span class="va">varName</span><span class="op">)</span>,</span>
<span>           <span class="fu"><a href="../reference/l_hist.html">l_hist</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">[</span> , <span class="va">varName</span><span class="op">]</span>, showFactors <span class="op">=</span> <span class="cn">TRUE</span>,  </span>
<span>                  xlabel <span class="op">=</span> <span class="va">varName</span>, title <span class="op">=</span> <span class="va">varName</span>, </span>
<span>                  linkingGroup <span class="op">=</span> <span class="st">"Motor Trend"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>These are not evaluated in this vignette. Note that all are in the
same <code>linkingGroup</code>.</p>
<p>Other linked plots might exist as well – for example, a scatterplot
of <code>gear</code> (the number of forward gears) versus
<code>disp</code> (the engine displacement in cubic inches).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">with</a></span><span class="op">(</span><span class="va">mtcars</span>, <span class="fu"><a href="../reference/l_plot.html">l_plot</a></span><span class="op">(</span><span class="va">disp</span>, <span class="va">cyl</span>, </span>
<span>                         xlabel <span class="op">=</span> <span class="st">"engine displacement"</span>, ylabel <span class="op">=</span> <span class="st">"number of cylinders"</span>,</span>
<span>                         title <span class="op">=</span> <span class="st">"1974 Motor Trend cars"</span>, </span>
<span>                         linkingGroup <span class="op">=</span> <span class="st">"Motor Trend"</span>,</span>
<span>                         size <span class="op">=</span> <span class="fl">10</span>, showScales <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         itemLabel <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mtcars</span><span class="op">)</span>, showItemLabels <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>                         <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Note that - each car’s name appears as the <code>itemLabel</code> for
that point in the plot (to be revealed as a “tooltip” style pop up), and
that - the plot <code>p</code> is in the same linking group as the
histograms.</p>
<p>Through a combination of selection, inversion, deactivation, and
reactivation, logical queries may be made interactively on the data.</p>
<p>For simplicity, the basic logical operators are illustrated below
using only the histograms. More generally, these apply to any
interactive <code>loon</code> graphic.</p>
</div>
<div class="section level2">
<h2 id="interactive-logical-operations">Interactive logical operations<a class="anchor" aria-label="anchor" href="#interactive-logical-operations"></a>
</h2>
<p>Five logical conditions/operations illustrated here are the basic
ones:</p>
<ol style="list-style-type: decimal">
<li>
<code>A</code> is <code>TRUE</code>
</li>
<li>Negation: (NOT <code>A</code>) is <code>TRUE</code>
</li>
<li>Inclusive OR: (<code>A</code> OR <code>B</code>) is
<code>TRUE</code> (one or the other or both),</li>
<li>Conjunction: (<code>A</code> AND <code>B</code>) are both
<code>TRUE</code>
</li>
<li>Exclusive OR: (<code>A</code> XOR <code>B</code>) meaning
(<code>A</code> is <code>TRUE</code>) or (<code>B</code> is
<code>TRUE</code>) but (<code>A</code> AND <code>B</code>) is FALSE</li>
</ol>
<p>Each of these corresponds to a sequence of actions on the plots
and/or inspector. Whatever is highlighted in the end corresponds to the
result.</p>
<p>Again, for simplicity all operations are illustrated by interacting
with values of categorical variates in the various histograms. Any of
the logical elements could also have been that satisfying numerical
constraints by undertaking the corresponding actions on a scatterplot
(or histogram of continuous values).</p>
<p>Each logical operator is illustrated in turn:</p>
<ol style="list-style-type: decimal">
<li>
<p><code>A</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">= A</annotation></semantics></math>)</p>
<p><em>on the plot</em> select <code>A</code>,</p>
<ul>
<li><p>e.g., click on <code>"manual"</code> bar from the
<code>Transmission</code> histogram</p></li>
<li><p>highlighted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⇔</mo><annotation encoding="application/x-tex">\iff</annotation></semantics></math><code>Transmission == "manual"</code> is <code>TRUE</code></p></li>
</ul>
</li>
<li>
<p><strong>NOT</strong> <code>A</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mover><mi>A</mi><mo accent="true">¯</mo></mover><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">= \overline{A}~~</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mo>¬</mo><mi>A</mi></mrow><annotation encoding="application/x-tex">~~\neg A</annotation></semantics></math>)</p>
<p><em>on a plot</em> select <code>A</code>,</p>
<p><em>from the inspector</em> click <code>invert</code></p>
<ul>
<li>
<p>e.g., click on <code>"North America"</code> bar from the
<code>continent</code> histogram,</p>
<p>then invert</p>
</li>
<li><p>highlighted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⇔</mo><annotation encoding="application/x-tex">\iff</annotation></semantics></math><code>continent == "North America"</code> is <code>FALSE</code></p></li>
<li><p>all that is highlighted is <strong>not</strong>
<code>"North America"</code>, namely <code>"Asia"</code> or
<code>"Europe"</code></p></li>
</ul>
</li>
<li>
<p><code>A</code> <strong>OR</strong> <code>B</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace></mrow><annotation encoding="application/x-tex">= A \cup B~~</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mspace width="0.222em"></mspace><mspace width="0.222em"></mspace><mi>A</mi><mo>∨</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">~~A \lor B</annotation></semantics></math>),</p>
<p><em>on a plot</em> select <code>A</code>,</p>
<p><em>on the same (or a different but linked) plot</em>
<code>&lt;SHIFT&gt;</code>- select <code>B</code></p>
<ul>
<li>
<p>e.g., click on <code>"manual"</code> bar from
<code>Transmission</code> histogram,</p>
<p>then while holding down the <code>&lt;SHIFT&gt;</code> key,</p>
<p>click on the <code>Mercedes</code> bar in the <code>company</code>
histogram</p>
</li>
<li><p>highlighted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mo>⇔</mo><annotation encoding="application/x-tex">\iff</annotation></semantics></math><code>Transmission == "manual"</code> is <code>TRUE</code>
<strong>OR</strong> <code>company = "Mercedes"</code> is
<code>TRUE</code> (or both)</p></li>
</ul>
</li>
<li>
<p><code>A</code> <strong>AND</strong> <code>B</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>A</mi><mo>∩</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">= A \cap B</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>∧</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">A \land B</annotation></semantics></math>)</p>
<p>lots of solutions, here is one that always works</p>
<p><em>on a plot</em> select <code>A</code>,</p>
<p><em>from the inspector</em>, <code>invert</code> then
<code>deactivate</code> (only <code>A</code> remains),</p>
<p><em>from a plot of the remaining</em> select <code>B</code>,</p>
<p><em>from the inspector</em> <code>reactivate</code> all</p>
<ul>
<li><p>elements are highlighted
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>⇔</mo><mi>A</mi><mo>∩</mo><mi>B</mi></mrow><annotation encoding="application/x-tex">\iff A \cap B</annotation></semantics></math></p></li>
<li><p>e.g. try highlighting all European cars with manual
transmissions.</p></li>
</ul>
</li>
<li>
<p><code>A</code> <strong>XOR</strong> <code>B</code>
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>∪</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∩</mo><mrow><mo stretchy="true" form="prefix">(</mo><mover><mrow><mi>A</mi><mo>∩</mo><mi>B</mi></mrow><mo accent="true">¯</mo></mover><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">= (A \cup B) \cap (\overline{A \cap B})</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>∨</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>∧</mo><mo>¬</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>∧</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">(A \lor B) \land \neg({A \land B})</annotation></semantics></math>)</p>
<p><em>following steps in 4</em>, select <code>A</code>
<strong>AND</strong> <code>B</code>,</p>
<p><em>from the inspector</em> <code>invert</code> then
<code>deactivate</code> (only
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>¬</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>A</mi><mo>∧</mo><mi>B</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\neg({A \land B})</annotation></semantics></math>
remains)</p>
<p><em>following steps in 3</em>, select <code>A</code>
<strong>OR</strong> <code>B</code>,</p>
<p><em>from the inspector</em> <code>reactivate</code> (only
<code>A</code> <strong>XOR</strong> <code>B</code> is
highlighted)</p>
</li>
</ol>
<p>Other logical conditions (including numerical ones such as
<code>disp &gt; 300</code> on the scatterplot <code>p</code>) are
constructed as a combination of the above (as in exclusive or).</p>
<p>These can be quite complex and it may help, after some number of
steps, to mark intermediary results by colour (or also glyph in
scatterplots).</p>
<p><strong>Note</strong> that because of possibly missing data, not all
linked plots may share the same set of observations.</p>
</div>
<div class="section level2">
<h2 id="missing-data-and-linking-keys">Missing data and linking keys<a class="anchor" aria-label="anchor" href="#missing-data-and-linking-keys"></a>
</h2>
<p>The <code>mtcars</code> data is an example of a complete data set.
Had there been missing values, then these would not appear in loon plots
that require them.</p>
<p>For example, suppose <code>data</code> has four variables
<code>A</code>, <code>B</code>, <code>C</code>, and <code>D</code>,
and</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>A <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                   B <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span>
<span>                   C <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"firebrick"</span>, <span class="st">"steelblue"</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>                   D <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="cn">NA</span><span class="op">)</span>, <span class="fl">10</span>, replace <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">p_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/l_plot.html">l_plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">A</span>, y <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">B</span>, color <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">C</span>, linkingGroup <span class="op">=</span> <span class="st">"test missing"</span><span class="op">)</span></span>
<span><span class="va">h_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/l_hist.html">l_hist</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">D</span>, color <span class="op">=</span> <span class="va">data</span><span class="op">$</span><span class="va">C</span>, linkingGroup <span class="op">=</span> <span class="st">"test missing"</span><span class="op">)</span></span></code></pre></div>
<p>Then</p>
<ul>
<li>
<p>wherever an <code>NA</code> appears in any of <code>A</code>,
<code>B</code>, or <code>C</code>, that point will be missing from
<code>p_test</code></p>
<p>Note that it is generally <em>not a good idea</em> to use
<code>C</code> for any simple display characteristic like
<code>color</code> if indeed <code>C</code> has missing values since
this will remove non-missing <code>x</code> and <code>y</code> values
from the plot. Not all values of <code>x</code> and <code>y</code> would
then be accessible from the plot for logical queries,</p>
</li>
<li><p>wherever an <code>NA</code> appears in either of <code>C</code>
or <code>D</code>, that point will be missing from
<code>h_test</code></p></li>
</ul>
<p>Using logical operations on the original <code>data</code> to change
plot properties (e.g. select values) can be challenging when data values
are missing in the plot (since what is missing depends on what was
missing at the time of its construction).</p>
<p>For example,</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p_test</span><span class="op">[</span><span class="st">"selected"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">data</span><span class="op">$</span><span class="va">A</span> <span class="op">&gt;</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p><strong>may not work</strong>!</p>
<ul>
<li><p>The logical operation on the data (<code>data$A &gt; 0</code>)
will typically be longer than the corresponding x value
<code>p_test["x"]</code> in the plot and so will not work.</p></li>
<li><p>Even if the logical vector is of the right length (and contains
no <code>NA</code>s itself), the values may not correctly match the data
points.</p></li>
</ul>
<p>There are <strong>two general approaches</strong> to logical queries
when <code>data</code> contains <code>NA</code>s.</p>
<ol style="list-style-type: decimal">
<li>
<p>Using <strong>complete data</strong></p>
<p>If, like <code>mtcars</code>, the data being used contains no
<code>NA</code>s then conducting logical queries on the plot will be
identical to conducting them on the data.</p>
<p>If the data is not complete (contains one or more <code>NA</code>),
it can be made complete by removing all observations (rows) that contain
an <code>NA</code>. E.g. replacing <code>data</code> by
<code>c_data &lt;- na.omit(data)</code>.</p>
<ul>
<li><p>any logic on <code>c_data</code> will match that on plots made
from <code>c_data</code>.</p></li>
<li><p>depending on the amount and pattern of missing data, <em>this
could critically reduce the amount of data in the
analysis</em>.</p></li>
</ul>
</li>
<li>
<p>Using <strong>the information in the loon plots</strong>. Of
course, this is the <strong>recommended</strong> approach when data is
missing.</p>
<p>Logical queries can then be made</p>
<ol style="list-style-type: lower-alpha">
<li>
<p><strong>directly on the plots</strong>, either</p>
<ul>
<li>interactively as described in the previous sections, or,</li>
<li>programmatically as in <code>p_test["x"] &gt; 0</code> in place of
<code>data$A &gt; 0</code>.</li>
</ul>
<p>or</p>
</li>
<li>
<p><strong>directly on the data and applied to the
plots</strong></p>
<p>To help manage this, the <code>linkingKey</code> <em>of each
plot</em> can be used.</p>
<ul>
<li>
<p>the default value for each plot is a character vector with
entries</p>
<p>from <code>"0"</code> to <code>"n-1"</code> where
<code>n =</code>nrow(data)`.</p>
<p>These are easily turned into the row numbers for the original
data.</p>
<p>E.g. in <code>p_test</code> the row numbers of <code>data</code> that
correspond to the points is</p>
<p><code>1 + as.numeric(p_test["linkingKey"])</code></p>
<p>Logical values for the rows of <code>data</code> can then select
points in <code>p</code> as follows</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">LogVal</span> <span class="op">&lt;-</span> <span class="va">data</span><span class="op">$</span><span class="va">A</span> <span class="op">&gt;</span> <span class="va">data</span><span class="op">$</span><span class="va">B</span></span>
<span><span class="va">p</span><span class="op">[</span><span class="st">"selected"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">logVal</span><span class="op">[</span><span class="fl">1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">p_test</span><span class="op">[</span><span class="st">"linkingKey"</span><span class="op">]</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<p>Similarly for <code>h_test</code>. E.g., compare
<code>p_test["linkingKey"]</code> and
<code>h_test["linkingKey]"</code>.</p>
</li>
</ul>
</li>
</ol>
<ul>
<li>
<p><strong>Note</strong>: the user can always provide their own
character vector <code>linkingKey</code> for their plots.</p>
<ul>
<li>E.g., <code>linkingKey = rownames(data)</code>
</li>
</ul>
<p>If so, then more care may be needed to use these to identify rows in
a logical vector.</p>
</li>
</ul>
</li>
</ol>
<div class="section level3">
<h3 id="loons-linking-model">loon’s linking model<a class="anchor" aria-label="anchor" href="#loons-linking-model"></a>
</h3>
<p>Loon’s linking model has the following three parts</p>
<ul>
<li>a <code>linkingGroup</code> which identifies which plots are
linked</li>
<li>a <code>linkingKey</code>, a character vector where each element is
a key uniquely identifying a single observation in the plot (no two
observations in the same plot can have the same value in the linking
key), and</li>
<li>the <em>linked display states</em> each plot has declared (e.g. see
<code>l_getlinkedStates()</code>).</li>
</ul>
<p>Observations in different plots (in the same linking group) are
linked (in that their linked states change together) if and only if they
have the same linking key.</p>
<p>Points appearing in different plots (in the same
<code>linkingGroup</code>) which matched on the value of their
<code>linkingKey</code> will share the same value for their linked
states.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Adrian Waddell, R. Wayne Oldford.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
